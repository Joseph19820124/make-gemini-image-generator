{
  "name": "E-commerce Product Image Generation",
  "description": "Automatically generate product images for new inventory items",
  "version": "1.0.0",
  "workflow": {
    "trigger": {
      "type": "airtable",
      "name": "New Product Added",
      "description": "Triggered when a new product is added to inventory",
      "table": "Products",
      "view": "Needs Images",
      "inputs": {
        "product_id": "string",
        "product_name": "string",
        "description": "string",
        "category": "string",
        "price": "number",
        "features": "array",
        "target_audience": "string",
        "brand": "string"
      }
    },
    "modules": [
      {
        "id": 1,
        "name": "Generate Product Variants",
        "app": "gemini-image-generator",
        "module": "batch-generate",
        "description": "Generate multiple product image variants",
        "configuration": {
          "prompts": [
            "{{trigger.product_name}}, professional product photography, white background, studio lighting, high-end commercial style",
            "{{trigger.product_name}}, lifestyle setting, {{trigger.target_audience}} using the product, natural lighting, realistic scene",
            "{{trigger.product_name}}, close-up detail shot, macro photography, highlighting key features, premium quality",
            "{{trigger.product_name}}, 45-degree angle, professional e-commerce style, clean background, sharp focus"
          ],
          "model": "imagen-4",
          "resolution": "1024x1024",
          "style": "realistic",
          "quality": "hd",
          "maintainConsistency": true
        },
        "outputs": {
          "product_images": "array",
          "generation_summary": "object"
        }
      },
      {
        "id": 2,
        "name": "Generate Brand Consistent Set",
        "app": "gemini-image-generator",
        "module": "generate-consistent-set",
        "description": "Generate brand-consistent product images",
        "configuration": {
          "basePrompt": "{{trigger.brand}} {{trigger.product_name}}, premium product photography",
          "variations": [
            "white background, studio lighting",
            "lifestyle environment, in use",
            "packaging and product together",
            "multiple angles composition"
          ],
          "style": "realistic",
          "resolution": "1024x1024"
        },
        "outputs": {
          "brand_images": "array"
        }
      },
      {
        "id": 3,
        "name": "Enhance Image Quality",
        "app": "gemini-image-generator",
        "module": "edit-image",
        "description": "Enhance the best generated images",
        "iterator": "{{1.product_images}}",
        "configuration": {
          "prompt": "Enhance image quality, increase sharpness and clarity, professional commercial photography style",
          "inputImage": "{{item.url}}",
          "editMode": "enhance",
          "strength": 0.7
        },
        "outputs": {
          "enhanced_images": "array"
        }
      },
      {
        "id": 4,
        "name": "Create Image Variants",
        "app": "tools",
        "module": "image-resizer",
        "description": "Create different sizes for various platforms",
        "configuration": {
          "source_images": "{{3.enhanced_images}}",
          "output_sizes": [
            {
              "name": "thumbnail",
              "width": 300,
              "height": 300,
              "crop": "center"
            },
            {
              "name": "medium",
              "width": 600,
              "height": 600,
              "crop": "center"
            },
            {
              "name": "large",
              "width": 1200,
              "height": 1200,
              "crop": "center"
            },
            {
              "name": "banner",
              "width": 1920,
              "height": 600,
              "crop": "center"
            }
          ]
        },
        "outputs": {
          "resized_images": "array"
        }
      },
      {
        "id": 5,
        "name": "Upload to Product CDN",
        "app": "aws-s3",
        "module": "upload-file",
        "description": "Upload images to CDN for fast delivery",
        "configuration": {
          "bucket": "product-images-cdn",
          "files": "{{4.resized_images}}",
          "folder": "products/{{trigger.category}}/{{trigger.product_id}}",
          "public_access": true,
          "cache_control": "max-age=31536000"
        },
        "outputs": {
          "cdn_urls": "array",
          "upload_summary": "object"
        }
      },
      {
        "id": 6,
        "name": "Update Product Database",
        "app": "airtable",
        "module": "update-record",
        "description": "Update product record with image URLs",
        "configuration": {
          "table": "Products",
          "record_id": "{{trigger.product_id}}",
          "fields": {
            "Image_URLs": "{{5.cdn_urls}}",
            "Primary_Image": "{{first(5.cdn_urls)}}",
            "Thumbnail_Image": "{{filter(5.cdn_urls; size; thumbnail)}}",
            "Images_Generated": true,
            "Generation_Date": "{{now}}",
            "Image_Count": "{{length(5.cdn_urls)}}"
          }
        },
        "outputs": {
          "updated_record": "object"
        }
      },
      {
        "id": 7,
        "name": "Sync to E-commerce Platform",
        "app": "shopify",
        "module": "update-product",
        "description": "Update Shopify product with new images",
        "configuration": {
          "product_id": "{{trigger.product_id}}",
          "images": {
            "primary": "{{first(5.cdn_urls)}}",
            "gallery": "{{5.cdn_urls}}",
            "alt_text": "{{trigger.product_name}} - {{trigger.description}}"
          },
          "update_seo": true
        },
        "outputs": {
          "shopify_product": "object"
        }
      },
      {
        "id": 8,
        "name": "Generate SEO Metadata",
        "app": "openai",
        "module": "text-completion",
        "description": "Generate SEO-optimized alt text and descriptions",
        "configuration": {
          "prompt": "Generate SEO-optimized alt text and image descriptions for: {{trigger.product_name}}. Description: {{trigger.description}}. Features: {{join(trigger.features; ', ')}}. Create 4 different alt texts for the product images focusing on different aspects.",
          "max_tokens": 200,
          "temperature": 0.7
        },
        "outputs": {
          "seo_metadata": "string",
          "alt_texts": "array"
        }
      },
      {
        "id": 9,
        "name": "Create Product Catalog Entry",
        "app": "google-sheets",
        "module": "add-row",
        "description": "Add entry to product catalog spreadsheet",
        "configuration": {
          "spreadsheet": "Product Catalog 2025",
          "worksheet": "Generated Images",
          "values": {
            "Product_ID": "{{trigger.product_id}}",
            "Product_Name": "{{trigger.product_name}}",
            "Category": "{{trigger.category}}",
            "Brand": "{{trigger.brand}}",
            "Generation_Date": "{{now}}",
            "Primary_Image_URL": "{{first(5.cdn_urls)}}",
            "Total_Images": "{{length(5.cdn_urls)}}",
            "Shopify_Updated": "{{if(7.shopify_product; 'Yes'; 'No')}}",
            "Status": "Completed"
          }
        },
        "outputs": {
          "catalog_entry": "object"
        }
      },
      {
        "id": 10,
        "name": "Quality Check Notification",
        "app": "slack",
        "module": "send-message",
        "description": "Notify team for manual quality review",
        "configuration": {
          "channel": "#product-team",
          "message": {
            "text": "üÜï New product images generated for {{trigger.product_name}}",
            "blocks": [
              {
                "type": "header",
                "text": {
                  "type": "plain_text",
                  "text": "Product Images Generated üì∏"
                }
              },
              {
                "type": "section",
                "fields": [
                  {
                    "type": "mrkdwn",
                    "text": "*Product:*\n{{trigger.product_name}}"
                  },
                  {
                    "type": "mrkdwn",
                    "text": "*Category:*\n{{trigger.category}}"
                  },
                  {
                    "type": "mrkdwn",
                    "text": "*Images Generated:*\n{{length(5.cdn_urls)}}"
                  },
                  {
                    "type": "mrkdwn",
                    "text": "*Status:*\n‚úÖ Uploaded to CDN\n{{if(7.shopify_product; '‚úÖ Synced to Shopify'; '‚ùå Shopify sync failed')}}"
                  }
                ]
              },
              {
                "type": "image",
                "image_url": "{{first(5.cdn_urls)}}",
                "alt_text": "{{trigger.product_name}} primary image"
              },
              {
                "type": "actions",
                "elements": [
                  {
                    "type": "button",
                    "text": {
                      "type": "plain_text",
                      "text": "View All Images"
                    },
                    "url": "{{5.upload_summary.folder_url}}"
                  },
                  {
                    "type": "button",
                    "text": {
                      "type": "plain_text",
                      "text": "View on Shopify"
                    },
                    "url": "{{7.shopify_product.admin_url}}"
                  }
                ]
              }
            ]
          }
        }
      }
    ]
  },
  "connections": {
    "gemini-connection": {
      "type": "gemini-image-generator",
      "configuration": {
        "apiKey": "{{env.GOOGLE_AI_API_KEY}}",
        "region": "us-central1"
      }
    },
    "airtable-connection": {
      "type": "airtable",
      "api_key": "{{env.AIRTABLE_API_KEY}}",
      "base_id": "{{env.AIRTABLE_PRODUCTS_BASE_ID}}"
    },
    "aws-s3-connection": {
      "type": "aws-s3",
      "access_key": "{{env.AWS_ACCESS_KEY_ID}}",
      "secret_key": "{{env.AWS_SECRET_ACCESS_KEY}}",
      "region": "us-east-1"
    },
    "shopify-connection": {
      "type": "shopify",
      "shop_domain": "{{env.SHOPIFY_SHOP_DOMAIN}}",
      "access_token": "{{env.SHOPIFY_ACCESS_TOKEN}}"
    }
  },
  "settings": {
    "error_handling": {
      "continue_on_error": false,
      "max_retries": 2,
      "retry_delay": "10s"
    },
    "execution": {
      "timeout": "15m",
      "max_concurrent": 2
    }
  }
}